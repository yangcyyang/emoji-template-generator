<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡¨æƒ…åŒ…æ¨¡æ¿ç”Ÿæˆå™¨ - å››æ¨¡æ¿</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @font-face {
            font-family: 'LiuhuanKatong';
            src: url('./åˆ˜æ¬¢å¡é€šæ‰‹ä¹¦.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'LiuhuanKatong', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #1a1a2e;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 2600px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 10px;
            font-size: 32px;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
            font-size: 16px;
        }

        /* æ§åˆ¶é¢æ¿ */
        .control-panel {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .control-row {
            display: flex;
            gap: 20px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .control-group {
            flex: 1;
            min-width: 200px;
        }

        .control-group label {
            display: block;
            color: #aaa;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .control-group input[type="text"] {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            background: rgba(255,255,255,0.05);
            color: #fff;
            font-size: 16px;
            font-family: inherit;
        }

        .control-group input[type="text"]:focus {
            outline: none;
            border-color: #FECF78;
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, #FECF78 0%, #FFB347 100%);
            color: #333;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(254, 207, 120, 0.3);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .btn-success {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: #fff;
        }

        /* å››æ¨¡æ¿é¢„è§ˆåŒº - 2x2ç½‘æ ¼ */
        .templates-wrapper {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            justify-items: center;
        }

        .template-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .template-section:hover {
            transform: scale(1.02);
        }

        .template-label {
            color: #FECF78;
            font-size: 18px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        /* ========== æ¨¡æ¿1æ ·å¼ - 1200Ã—1600 ========== */
        .template1-card {
            width: 600px;
            height: 800px;
            background: #fff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
        }

        .template1-header {
            height: 320px;
            display: flex;
            padding: 20px;
            gap: 20px;
            background: linear-gradient(135deg, #FECF78 0%, #FFB347 100%);
            flex-shrink: 0;
        }

        .template1-header-left {
            flex: 0 0 280px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .template1-main-image {
            width: 280px;
            height: 280px;
            object-fit: contain;
        }

        .template1-header-right {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .template1-header-top {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 10px;
            padding: 5px 0;
        }

        .template1-count {
            color: rgba(255,255,255,0.95);
            font-size: 14px;
            font-weight: 500;
        }

        .template1-icons {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .template1-icons svg,
        .template1-icons .social-icon {
            width: 24px;
            height: 24px;
            display: block;
            flex-shrink: 0;
            object-fit: contain;
        }

        .template1-header-bottom {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            gap: 10px;
        }

        .template1-title {
            color: #fff;
            font-size: 42px;
            font-weight: 700;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.2);
            line-height: 1.2;
        }

        .template1-subtitle {
            color: rgba(255,255,255,0.95);
            font-size: 30px;
            font-weight: 500;
            text-shadow: 1px 1px 4px rgba(0,0,0,0.2);
        }

        .template1-grid {
            background: #fff;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 0;
            flex: 1;
        }

        .template1-item {
            background: transparent;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 200px;
            height: 160px;
        }

        .template1-item img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* ========== æ¨¡æ¿2/3/4æ ·å¼ - 1200Ã—1600 çº¯ç½‘æ ¼ ========== */
        .template-grid-card {
            width: 600px;
            height: 800px;
            background: #fff;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(3, 200px);
            grid-template-rows: repeat(5, 160px);
            gap: 0;
            width: 600px;
            height: 800px;
        }

        .template-grid-item {
            width: 200px;
            height: 160px;
            background: transparent;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .template-grid-item img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* å ä½ç¬¦ */
        .placeholder {
            color: #ccc;
            font-size: 14px;
            background: #f0f0f0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* æ“ä½œæŒ‰é’® */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            justify-content: center;
        }

        .action-buttons .btn {
            padding: 16px 40px;
            font-size: 18px;
        }

        /* è·¯å¾„æ˜¾ç¤º */
        .path-display {
            color: #FECF78;
            font-size: 14px;
            margin-top: 8px;
            word-break: break-all;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading.active {
            display: flex;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.1);
            border-top-color: #FECF78;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading p {
            color: #fff;
            margin-top: 16px;
            font-size: 16px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        #folder-input, #main-image-input {
            display: none;
        }

        /* å¤§å›¾é¢„è§ˆæ¨¡æ€æ¡† */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            max-width: 90%;
            max-height: 90%;
            background: #fff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .modal-content img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            display: block;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            color: #fff;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: rgba(255,255,255,0.3);
        }

        /* å“åº”å¼ */
        @media (max-width: 1300px) {
            .templates-wrapper {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ è¡¨æƒ…åŒ…æ¨¡æ¿ç”Ÿæˆå™¨</h1>
        <p class="subtitle">å››æ¨¡æ¿åŒæ—¶é¢„è§ˆï¼ˆç‚¹å‡»æ¨¡æ¿æŸ¥çœ‹å¤§å›¾ï¼‰- æ¨¡æ¿2/3/4æŒ‰æ­£åºå¾ªç¯åˆ†é…å›¾ç‰‡</p>

        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="control-panel">
            <div class="control-row">
                <div class="control-group" style="flex: 2;">
                    <label>ğŸ“ è¡¨æƒ…åŒ…å›¾ç‰‡æ–‡ä»¶å¤¹ï¼ˆæ¨¡æ¿2/3/4å„éœ€15å¼ ï¼Œå…±45å¼ ï¼Œä¸è¶³åˆ™å¾ªç¯ï¼‰</label>
                    <input type="text" id="folder-path" placeholder="é€‰æ‹©åŒ…å«è¡¨æƒ…åŒ…çš„æ–‡ä»¶å¤¹">
                    <div class="path-display" id="path-display"></div>
                </div>
                <div class="control-group" style="flex: 0 0 auto; display: flex; align-items: flex-end;">
                    <button class="btn btn-secondary" onclick="selectFolder()">ğŸ“‚ é€‰æ‹©æ–‡ä»¶å¤¹</button>
                    <input type="file" id="folder-input" webkitdirectory directory multiple onchange="handleFolderSelect(event)">
                </div>
            </div>

            <div class="control-row">
                <div class="control-group" style="flex: 2;">
                    <label>ğŸ–¼ï¸ æ¨¡æ¿1è‡ªå®šä¹‰ä¸»å›¾ï¼ˆå¯é€‰ï¼Œä¸é€‰åˆ™éšæœºæŠ½å–ï¼‰</label>
                    <input type="text" id="main-image-path" placeholder="ä¸é€‰åˆ™éšæœºï¼Œç‚¹å‡»å³ä¾§å¯æŒ‡å®šä¸»å›¾" readonly>
                    <div class="path-display" id="main-image-display">æœªé€‰æ‹©ï¼Œæ¨¡æ¿1å°†éšæœºæŠ½å–ä¸»å›¾</div>
                </div>
                <div class="control-group" style="flex: 0 0 auto; display: flex; align-items: flex-end;">
                    <button class="btn btn-secondary" onclick="selectMainImage()">ğŸ–¼ï¸ é€‰æ‹©ä¸»å›¾</button>
                    <input type="file" id="main-image-input" accept="image/*" onchange="handleMainImageSelect(event)">
                </div>
            </div>

            <div class="control-row">
                <div class="control-group">
                    <label>ä¸»æ ‡é¢˜</label>
                    <input type="text" id="main-title-input" value="èˆªæµ·ç‹" placeholder="è¾“å…¥ä¸»æ ‡é¢˜">
                </div>
                <div class="control-group">
                    <label>å‰¯æ ‡é¢˜</label>
                    <input type="text" id="sub-title-input" value="2026æ–°å¹´è¡¨æƒ…åŒ…" placeholder="è¾“å…¥å‰¯æ ‡é¢˜">
                </div>
                <div class="control-group">
                    <label>è¡¨æƒ…åŒ…æ•°é‡</label>
                    <input type="text" id="count-input" value="é™æ€è¡¨æƒ…åŒ… 40å¼ " placeholder="å¦‚ï¼š40å¼ ">
                </div>
            </div>

            <div class="control-row">
                <div class="control-group">
                    <label>ğŸ¨ å¤´å›¾èƒŒæ™¯è‰² <small>(ç•™ç©ºåˆ™è‡ªåŠ¨æå–ä¸»å›¾è‰²è°ƒ)</small></label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <input type="color" id="header-bg-color" value="" style="width: 60px; height: 36px; padding: 2px; cursor: pointer;">
                        <input type="text" id="header-bg-color-text" placeholder="#FFB347 æˆ– rgba(255,179,71,0.9)" style="flex: 1;">
                        <button class="btn btn-secondary" onclick="resetHeaderBgColor()" style="padding: 8px 16px; font-size: 12px;">ğŸ”„ é‡ç½®è‡ªåŠ¨</button>
                    </div>
                    <div class="path-display" id="header-bg-display">å½“å‰ï¼šè‡ªåŠ¨æå–ä¸»å›¾è‰²è°ƒ</div>
                </div>
                <div class="control-group">
                    <label>ğŸ“ ä¸»å›¾æ˜¾ç¤ºæ¨¡å¼</label>
                    <select id="main-image-fit" style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #444; background: rgba(255,255,255,0.05); color: #fff;">
                        <option value="contain">Contain (é€‚åº”æ¡†å†…ï¼Œä¸è£å‰ª)</option>
                        <option value="cover">Cover (å¡«æ»¡æ¡†ï¼Œå¯èƒ½è£å‰ª)</option>
                        <option value="fill">Fill (æ‹‰ä¼¸å¡«æ»¡ï¼Œå¯èƒ½å˜å½¢)</option>
                    </select>
                    <div class="path-display" id="main-image-fit-display">æ¨èï¼šContain ä¿æŒåŸå§‹æ¯”ä¾‹</div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="generatePreviews()">âœ¨ ç”Ÿæˆå››æ¨¡æ¿é¢„è§ˆ</button>
                <button class="btn btn-success" onclick="downloadAll()">ğŸ’¾ ä¸‹è½½å…¨éƒ¨å››ä¸ªæ¨¡æ¿</button>
            </div>
        </div>

        <!-- å››æ¨¡æ¿é¢„è§ˆåŒº -->
        <div class="templates-wrapper">
            <!-- æ¨¡æ¿1 -->
            <div class="template-section" onclick="showModal('template1-card')">
                <div class="template-label">æ¨¡æ¿1 - å¤´å›¾+æ ‡é¢˜+ä¹å®«æ ¼ï¼ˆéšæœº10å¼ ï¼‰</div>
                <div class="template1-card" id="template1-card">
                    <div class="template1-header" id="template1-header">
                        <div class="template1-header-left">
                            <img class="template1-main-image" id="template1-main-img" src="" alt="ä¸»å›¾" style="display: none;">
                            <div class="placeholder" id="template1-main-placeholder">ä¸»å›¾</div>
                        </div>
                        <div class="template1-header-right">
                            <div class="template1-header-top">
                                <span class="template1-count" id="template1-count">é™æ€è¡¨æƒ…åŒ… 40å¼ </span>
                                <div class="template1-icons">
                                    <img src="data:image/png;base64,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" alt="å¾®ä¿¡" class="social-icon">
                                    <img src="data:image/png;base64,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" alt="QQ" class="social-icon">
                                </div>
                            </div>
                            <div class="template1-header-bottom">
                                <div class="template1-title" id="template1-title">èˆªæµ·ç‹</div>
                                <div class="template1-subtitle" id="template1-subtitle">2026æ–°å¹´è¡¨æƒ…åŒ…</div>
                            </div>
                        </div>
                    </div>
                    <div class="template1-grid" id="template1-grid">
                        <div class="template1-item"><span class="placeholder">1</span></div>
                        <div class="template1-item"><span class="placeholder">2</span></div>
                        <div class="template1-item"><span class="placeholder">3</span></div>
                        <div class="template1-item"><span class="placeholder">4</span></div>
                        <div class="template1-item"><span class="placeholder">5</span></div>
                        <div class="template1-item"><span class="placeholder">6</span></div>
                        <div class="template1-item"><span class="placeholder">7</span></div>
                        <div class="template1-item"><span class="placeholder">8</span></div>
                        <div class="template1-item"><span class="placeholder">9</span></div>
                    </div>
                </div>
            </div>

            <!-- æ¨¡æ¿2 -->
            <div class="template-section" onclick="showModal('template2-card')">
                <div class="template-label">æ¨¡æ¿2 - 3Ã—5ç½‘æ ¼ï¼ˆæ­£åº1-15å¼ ï¼‰</div>
                <div class="template-grid-card" id="template2-card">
                    <div class="template-grid" id="template2-grid">
                        <!-- 15ä¸ªå ä½ -->
                        <div class="template-grid-item"><span class="placeholder">1</span></div>
                        <div class="template-grid-item"><span class="placeholder">2</span></div>
                        <div class="template-grid-item"><span class="placeholder">3</span></div>
                        <div class="template-grid-item"><span class="placeholder">4</span></div>
                        <div class="template-grid-item"><span class="placeholder">5</span></div>
                        <div class="template-grid-item"><span class="placeholder">6</span></div>
                        <div class="template-grid-item"><span class="placeholder">7</span></div>
                        <div class="template-grid-item"><span class="placeholder">8</span></div>
                        <div class="template-grid-item"><span class="placeholder">9</span></div>
                        <div class="template-grid-item"><span class="placeholder">10</span></div>
                        <div class="template-grid-item"><span class="placeholder">11</span></div>
                        <div class="template-grid-item"><span class="placeholder">12</span></div>
                        <div class="template-grid-item"><span class="placeholder">13</span></div>
                        <div class="template-grid-item"><span class="placeholder">14</span></div>
                        <div class="template-grid-item"><span class="placeholder">15</span></div>
                    </div>
                </div>
            </div>

            <!-- æ¨¡æ¿3 -->
            <div class="template-section" onclick="showModal('template3-card')">
                <div class="template-label">æ¨¡æ¿3 - 3Ã—5ç½‘æ ¼ï¼ˆæ­£åº16-30å¼ ï¼‰</div>
                <div class="template-grid-card" id="template3-card">
                    <div class="template-grid" id="template3-grid">
                        <!-- 15ä¸ªå ä½ -->
                        <div class="template-grid-item"><span class="placeholder">16</span></div>
                        <div class="template-grid-item"><span class="placeholder">17</span></div>
                        <div class="template-grid-item"><span class="placeholder">18</span></div>
                        <div class="template-grid-item"><span class="placeholder">19</span></div>
                        <div class="template-grid-item"><span class="placeholder">20</span></div>
                        <div class="template-grid-item"><span class="placeholder">21</span></div>
                        <div class="template-grid-item"><span class="placeholder">22</span></div>
                        <div class="template-grid-item"><span class="placeholder">23</span></div>
                        <div class="template-grid-item"><span class="placeholder">24</span></div>
                        <div class="template-grid-item"><span class="placeholder">25</span></div>
                        <div class="template-grid-item"><span class="placeholder">26</span></div>
                        <div class="template-grid-item"><span class="placeholder">27</span></div>
                        <div class="template-grid-item"><span class="placeholder">28</span></div>
                        <div class="template-grid-item"><span class="placeholder">29</span></div>
                        <div class="template-grid-item"><span class="placeholder">30</span></div>
                    </div>
                </div>
            </div>

            <!-- æ¨¡æ¿4 -->
            <div class="template-section" onclick="showModal('template4-card')">
                <div class="template-label">æ¨¡æ¿4 - 3Ã—5ç½‘æ ¼ï¼ˆæ­£åº31-45å¼ ï¼‰</div>
                <div class="template-grid-card" id="template4-card">
                    <div class="template-grid" id="template4-grid">
                        <!-- 15ä¸ªå ä½ -->
                        <div class="template-grid-item"><span class="placeholder">31</span></div>
                        <div class="template-grid-item"><span class="placeholder">32</span></div>
                        <div class="template-grid-item"><span class="placeholder">33</span></div>
                        <div class="template-grid-item"><span class="placeholder">34</span></div>
                        <div class="template-grid-item"><span class="placeholder">35</span></div>
                        <div class="template-grid-item"><span class="placeholder">36</span></div>
                        <div class="template-grid-item"><span class="placeholder">37</span></div>
                        <div class="template-grid-item"><span class="placeholder">38</span></div>
                        <div class="template-grid-item"><span class="placeholder">39</span></div>
                        <div class="template-grid-item"><span class="placeholder">40</span></div>
                        <div class="template-grid-item"><span class="placeholder">41</span></div>
                        <div class="template-grid-item"><span class="placeholder">42</span></div>
                        <div class="template-grid-item"><span class="placeholder">43</span></div>
                        <div class="template-grid-item"><span class="placeholder">44</span></div>
                        <div class="template-grid-item"><span class="placeholder">45</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠ è½½åŠ¨ç”» -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p id="loading-text">æ­£åœ¨ç”Ÿæˆ...</p>
    </div>

    <!-- å¤§å›¾é¢„è§ˆæ¨¡æ€æ¡† -->
    <div class="modal" id="modal" onclick="closeModal()">
        <button class="modal-close" onclick="closeModal()">Ã—</button>
        <div class="modal-content" id="modal-content" onclick="event.stopPropagation()">
            <!-- åŠ¨æ€æ’å…¥å¤§å›¾ -->
        </div>
    </div>

    <script>
        let allImages = [];
        let mainImageFile = null;
        
        // é¢œè‰²é€‰æ‹©å™¨è”åŠ¨
        document.getElementById('header-bg-color').addEventListener('input', function(e) {
            document.getElementById('header-bg-color-text').value = e.target.value;
            document.getElementById('header-bg-display').textContent = 'å·²é€‰æ‹©ï¼š' + e.target.value + 'ï¼ˆç‚¹å‡»ç”Ÿæˆæ¨¡æ¿åº”ç”¨ï¼‰';
            document.getElementById('header-bg-display').style.color = '#FECF78';
        });
        
        document.getElementById('header-bg-color-text').addEventListener('input', function(e) {
            if (e.target.value) {
                document.getElementById('header-bg-color').value = e.target.value;
            }
        });
        
        // ä¸»å›¾æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢æç¤º
        document.getElementById('main-image-fit').addEventListener('change', function(e) {
            const fitDisplay = document.getElementById('main-image-fit-display');
            const mode = e.target.value;
            if (mode === 'contain') {
                fitDisplay.innerHTML = 'âœ… Contain æ¨¡å¼ï¼šä¿æŒåŸå§‹æ¯”ä¾‹ï¼Œæ¨è';
                fitDisplay.style.color = '#51cf66';
            } else if (mode === 'cover') {
                fitDisplay.innerHTML = 'Cover æ¨¡å¼ï¼šå¡«æ»¡åŒºåŸŸï¼Œå¯èƒ½è£å‰ªè¾¹ç¼˜';
                fitDisplay.style.color = '#FECF78';
            } else {
                fitDisplay.innerHTML = 'âš ï¸ Fill æ¨¡å¼ï¼šæ‹‰ä¼¸å¡«æ»¡ï¼Œå¯èƒ½å˜å½¢';
                fitDisplay.style.color = '#ff6b6b';
            }
        });
        
        // é‡ç½®èƒŒæ™¯è‰²
        function resetHeaderBgColor() {
            document.getElementById('header-bg-color').value = '#FFB347';
            document.getElementById('header-bg-color-text').value = '';
            document.getElementById('header-bg-display').textContent = 'å½“å‰ï¼šè‡ªåŠ¨æå–ä¸»å›¾è‰²è°ƒ';
            document.getElementById('header-bg-display').style.color = '#888';
        }

        function selectFolder() {
            document.getElementById('folder-input').click();
        }

        function handleFolderSelect(event) {
            const files = Array.from(event.target.files);
            const imageFiles = files.filter(f => 
                f.type.startsWith('image/') && 
                !f.name.startsWith('.') &&
                !f.name.includes('__MACOSX')
            );

            if (imageFiles.length < 1) {
                alert('æœªæ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶');
                return;
            }

            // æŒ‰æ–‡ä»¶åæ­£åºæ’åº
            allImages = imageFiles.sort((a, b) => a.name.localeCompare(b.name));
            
            const folderName = files[0]?.webkitRelativePath?.split('/')[0] || 'å·²é€‰æ‹©æ–‡ä»¶å¤¹';
            document.getElementById('path-display').textContent = 
                `${folderName} (${imageFiles.length} å¼ å›¾ç‰‡ï¼Œå·²æŒ‰æ–‡ä»¶åæ­£åºæ’åº)`;
            
            // æ™ºèƒ½æ‹†åˆ†æ ‡é¢˜
            const { mainTitle, subTitle } = parseFolderName(folderName);
            document.getElementById('main-title-input').value = mainTitle;
            document.getElementById('sub-title-input').value = subTitle;
            
            showToast(`ğŸ“ å·²è¯»å– ${imageFiles.length} å¼ å›¾ç‰‡`);
        }

        function parseFolderName(folderName) {
            let cleanName = folderName.replace(/\.zip$/i, '').replace(/^æœªå‘½åæ–‡ä»¶å¤¹$/i, '').trim();
            if (!cleanName) return { mainTitle: 'è¡¨æƒ…åŒ…', subTitle: '' };
            
            const separators = /[\s\-_Â·]+/;
            const parts = cleanName.split(separators).filter(p => p.trim());
            
            if (cleanName.includes('è¡¨æƒ…åŒ…')) {
                const emojiIndex = parts.findIndex(p => p.includes('è¡¨æƒ…åŒ…'));
                if (emojiIndex > 0) {
                    const mainParts = parts.slice(0, emojiIndex + 1);
                    const subParts = parts.slice(emojiIndex + 1);
                    return {
                        mainTitle: mainParts.join(''),
                        subTitle: subParts.join('') || 'ç²¾é€‰åˆé›†'
                    };
                } else if (emojiIndex === 0 && parts.length > 1) {
                    return { mainTitle: parts[0], subTitle: parts.slice(1).join('') };
                } else {
                    return { mainTitle: cleanName, subTitle: 'ç²¾é€‰åˆé›†' };
                }
            }
            
            const themeWords = ['æ˜¥å­£', 'å¤å­£', 'ç§‹å­£', 'å†¬å­£', 'æ˜¥å¤©', 'å¤å¤©', 'ç§‹å¤©', 'å†¬å¤©', 
                               'æ–°å¹´', 'æ˜¥èŠ‚', 'åœ£è¯', 'ä¸‡åœ£èŠ‚', 'æƒ…äººèŠ‚', 'å¤æ—¥', 'å†¬æ—¥',
                               'æ—¥å¸¸', 'å·¥ä½œ', 'å­¦ä¹ ', 'æ‹çˆ±', 'èŒç³»', 'æ…µæ‡’', 'å¯çˆ±'];
            
            for (let i = 0; i < parts.length; i++) {
                if (themeWords.some(theme => parts[i].includes(theme))) {
                    const mainParts = parts.slice(0, i + 1);
                    const subParts = parts.slice(i + 1);
                    let subTitle = subParts.join('');
                    if (!subTitle) {
                        subTitle = i > 0 ? mainParts.pop() : 'è¡¨æƒ…åŒ…';
                    }
                    return { mainTitle: mainParts.join('') + 'è¡¨æƒ…åŒ…', subTitle: subTitle };
                }
            }
            
            if (parts.length === 1) {
                return { mainTitle: cleanName + 'è¡¨æƒ…åŒ…', subTitle: 'ç²¾é€‰åˆé›†' };
            }
            
            const mid = Math.ceil(parts.length / 2);
            return { mainTitle: parts.slice(0, mid).join('') + 'è¡¨æƒ…åŒ…', subTitle: parts.slice(mid).join('') || 'ç²¾é€‰åˆé›†' };
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function selectMainImage() {
            document.getElementById('main-image-input').click();
        }

        function handleMainImageSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            if (!file.type.startsWith('image/')) {
                alert('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
                return;
            }
            mainImageFile = file;
            document.getElementById('main-image-path').value = file.name;
            document.getElementById('main-image-display').textContent = `å·²é€‰æ‹©: ${file.name}ï¼ˆå°†æ›¿æ¢æ¨¡æ¿1éšæœºä¸»å›¾ï¼‰`;
            showToast('ğŸ–¼ï¸ ä¸»å›¾å·²é€‰æ‹©');
        }

        function readFileAsDataURL(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.readAsDataURL(file);
            });
        }

        // æŒ‰æ­£åºå¾ªç¯è·å–å›¾ç‰‡ï¼ˆæ¨¡æ¿2/3/4ä½¿ç”¨ï¼‰
        function getSequentialImages(templateIndex) {
            // templateIndex: 0=æ¨¡æ¿2, 1=æ¨¡æ¿3, 2=æ¨¡æ¿4
            const startIndex = templateIndex * 15; // 0, 15, 30
            const result = [];
            
            for (let i = 0; i < 15; i++) {
                const index = (startIndex + i) % allImages.length;
                result.push(allImages[index]);
            }
            
            return result;
        }

        async function generatePreviews() {
            if (allImages.length < 1) {
                alert('è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶å¤¹');
                return;
            }

            const loading = document.getElementById('loading');
            loading.classList.add('active');

            try {
                // æ›´æ–°æ¨¡æ¿1æ–‡å­—
                document.getElementById('template1-title').textContent = document.getElementById('main-title-input').value;
                document.getElementById('template1-subtitle').textContent = document.getElementById('sub-title-input').value;
                document.getElementById('template1-count').textContent = document.getElementById('count-input').value;

                // ========== æ¨¡æ¿1ï¼šéšæœºæŠ½å–10å¼  ==========
                const shuffledForT1 = shuffleArray(allImages);
                const t1MainImgFile = mainImageFile || shuffledForT1[0];
                const t1MainData = await readFileAsDataURL(t1MainImgFile);
                
                const t1MainImg = document.getElementById('template1-main-img');
                t1MainImg.src = t1MainData;
                t1MainImg.style.display = 'block';
                document.getElementById('template1-main-placeholder').style.display = 'none';

                // åº”ç”¨ä¸»å›¾æ˜¾ç¤ºæ¨¡å¼
                const fitMode = document.getElementById('main-image-fit').value;
                t1MainImg.style.objectFit = fitMode;
                
                // æ£€æŸ¥ä¸»å›¾æ¯”ä¾‹å¹¶æ˜¾ç¤ºæç¤º
                const tempImg = new Image();
                tempImg.src = t1MainData;
                tempImg.onload = () => {
                    const aspectRatio = tempImg.width / tempImg.height;
                    const isSquare = aspectRatio >= 0.9 && aspectRatio <= 1.1;
                    const fitDisplay = document.getElementById('main-image-fit-display');
                    
                    if (fitMode === 'fill' && !isSquare) {
                        fitDisplay.innerHTML = 'âš ï¸ è­¦å‘Šï¼šå½“å‰ä¸ºæ‹‰ä¼¸æ¨¡å¼ï¼Œå›¾ç‰‡å¯èƒ½å˜å½¢ã€‚å»ºè®®åˆ‡æ¢ä¸º Contain æˆ– Cover';
                        fitDisplay.style.color = '#ff6b6b';
                    } else if (fitMode === 'contain') {
                        fitDisplay.innerHTML = 'âœ… Contain æ¨¡å¼ï¼šä¿æŒåŸå§‹æ¯”ä¾‹' + (isSquare ? 'ï¼ˆå›¾ç‰‡ä¸ºæ­£æ–¹å½¢ï¼Œå®Œç¾é€‚é…ï¼‰' : 'ï¼ˆéæ­£æ–¹å½¢ï¼Œå¯èƒ½æœ‰ç•™ç™½ï¼‰');
                        fitDisplay.style.color = '#51cf66';
                    } else {
                        fitDisplay.innerHTML = 'å½“å‰ï¼š' + fitMode + ' æ¨¡å¼';
                        fitDisplay.style.color = '#888';
                    }
                    
                    // å¤„ç†èƒŒæ™¯è‰²
                    const customColor = document.getElementById('header-bg-color-text').value || document.getElementById('header-bg-color').value;
                    if (customColor) {
                        // ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰é¢œè‰²
                        document.getElementById('template1-header').style.background = customColor;
                        document.getElementById('header-bg-display').textContent = 'å½“å‰ï¼šè‡ªå®šä¹‰é¢œè‰² ' + customColor;
                        document.getElementById('header-bg-display').style.color = '#51cf66';
                    } else {
                        // è‡ªåŠ¨æå–ä¸»è‰²è°ƒ
                        try {
                            const colorThief = new ColorThief();
                            const color = colorThief.getColor(tempImg);
                            const rgba = `rgba(${color[0]}, ${color[1]}, ${color[2]}, 0.9)`;
                            document.getElementById('template1-header').style.background = rgba;
                            document.getElementById('header-bg-display').textContent = 'å½“å‰ï¼šè‡ªåŠ¨æå–ä¸»å›¾è‰²è°ƒ';
                            document.getElementById('header-bg-display').style.color = '#888';
                        } catch(e) {}
                    }
                };

                // å¡«å……æ¨¡æ¿1çš„9å¼ è¡¨æƒ…åŒ…
                const t1Grid = document.getElementById('template1-grid');
                t1Grid.innerHTML = '';
                const t1StickerImages = mainImageFile ? shuffledForT1.slice(0, 9) : shuffledForT1.slice(1, 10);
                
                for (let i = 0; i < 9; i++) {
                    const imgData = await readFileAsDataURL(t1StickerImages[i]);
                    const item = document.createElement('div');
                    item.className = 'template1-item';
                    const img = document.createElement('img');
                    img.src = imgData;
                    img.alt = `${i+1}`;
                    item.appendChild(img);
                    t1Grid.appendChild(item);
                }

                // ========== æ¨¡æ¿2ï¼šæ­£åº1-15å¼ ï¼ˆå¾ªç¯ï¼‰==========
                const t2Images = getSequentialImages(0);
                const t2Grid = document.getElementById('template2-grid');
                t2Grid.innerHTML = '';
                for (let i = 0; i < 15; i++) {
                    const imgData = await readFileAsDataURL(t2Images[i]);
                    const item = document.createElement('div');
                    item.className = 'template-grid-item';
                    const img = document.createElement('img');
                    img.src = imgData;
                    img.alt = `${i+1}`;
                    item.appendChild(img);
                    t2Grid.appendChild(item);
                }

                // ========== æ¨¡æ¿3ï¼šæ­£åº16-30å¼ ï¼ˆå¾ªç¯ï¼‰==========
                const t3Images = getSequentialImages(1);
                const t3Grid = document.getElementById('template3-grid');
                t3Grid.innerHTML = '';
                for (let i = 0; i < 15; i++) {
                    const imgData = await readFileAsDataURL(t3Images[i]);
                    const item = document.createElement('div');
                    item.className = 'template-grid-item';
                    const img = document.createElement('img');
                    img.src = imgData;
                    img.alt = `${i+16}`;
                    item.appendChild(img);
                    t3Grid.appendChild(item);
                }

                // ========== æ¨¡æ¿4ï¼šæ­£åº31-45å¼ ï¼ˆå¾ªç¯ï¼‰==========
                const t4Images = getSequentialImages(2);
                const t4Grid = document.getElementById('template4-grid');
                t4Grid.innerHTML = '';
                for (let i = 0; i < 15; i++) {
                    const imgData = await readFileAsDataURL(t4Images[i]);
                    const item = document.createElement('div');
                    item.className = 'template-grid-item';
                    const img = document.createElement('img');
                    img.src = imgData;
                    img.alt = `${i+31}`;
                    item.appendChild(img);
                    t4Grid.appendChild(item);
                }

                showToast('âœ¨ å››æ¨¡æ¿é¢„è§ˆç”ŸæˆæˆåŠŸï¼ç‚¹å‡»æ¨¡æ¿æŸ¥çœ‹å¤§å›¾');
            } catch (error) {
                console.error(error);
                alert('ç”Ÿæˆå¤±è´¥ï¼š' + error.message);
            } finally {
                loading.classList.remove('active');
            }
        }

        // ä¿®å¤ html2canvas ä¸æ”¯æŒ object-fit çš„é—®é¢˜
        function fixImagesForCapture(container) {
            const images = container.querySelectorAll('img');
            const originalData = [];
            
            images.forEach((img, index) => {
                const computedStyle = window.getComputedStyle(img);
                const objectFit = computedStyle.objectFit;
                
                if (objectFit && objectFit !== 'fill') {
                    // ä¿å­˜åŸå§‹æ•°æ®
                    originalData.push({
                        element: img,
                        parent: img.parentNode,
                        src: img.src,
                        width: img.width,
                        height: img.height,
                        objectFit: objectFit
                    });
                    
                    // åˆ›å»ºæ›¿ä»£ div ä½¿ç”¨ background-image
                    const div = document.createElement('div');
                    div.style.width = computedStyle.width;
                    div.style.height = computedStyle.height;
                    div.style.backgroundImage = `url(${img.src})`;
                    div.style.backgroundSize = objectFit === 'contain' ? 'contain' : 
                                               objectFit === 'cover' ? 'cover' : '100% 100%';
                    div.style.backgroundPosition = 'center';
                    div.style.backgroundRepeat = 'no-repeat';
                    div.style.display = computedStyle.display;
                    div.className = img.className;
                    
                    img.parentNode.replaceChild(div, img);
                }
            });
            
            return originalData;
        }
        
        // æ¢å¤åŸå§‹å›¾ç‰‡
        function restoreImages(originalData) {
            originalData.forEach(data => {
                const img = document.createElement('img');
                img.src = data.src;
                img.className = data.element.className;
                img.style.width = data.width + 'px';
                img.style.height = data.height + 'px';
                img.style.objectFit = data.objectFit;
                img.style.display = data.element.style.display;
                data.parent.replaceChild(img, data.parent.querySelector('div') || data.parent.firstChild);
            });
        }

        async function downloadAll() {
            const loading = document.getElementById('loading');
            const loadingText = document.getElementById('loading-text');
            loading.classList.add('active');

            const templates = [
                { id: 'template1-card', name: 'æ¨¡æ¿1' },
                { id: 'template2-card', name: 'æ¨¡æ¿2' },
                { id: 'template3-card', name: 'æ¨¡æ¿3' },
                { id: 'template4-card', name: 'æ¨¡æ¿4' }
            ];

            const folderName = document.getElementById('main-title-input').value;
            const timestamp = Date.now();

            try {
                for (let i = 0; i < templates.length; i++) {
                    const template = templates[i];
                    loadingText.textContent = `æ­£åœ¨æ¸²æŸ“${template.name}...`;
                    
                    const element = document.getElementById(template.id);
                    
                    // ä¿®å¤å›¾ç‰‡ object-fit
                    const originalData = fixImagesForCapture(element);
                    
                    const canvas = await html2canvas(element, {
                        scale: 2,
                        useCORS: true,
                        allowTaint: false,
                        backgroundColor: '#ffffff',
                        logging: false
                    });
                    
                    // æ¢å¤åŸå§‹å›¾ç‰‡
                    restoreImages(originalData);
                    
                    const link = document.createElement('a');
                    link.download = `${template.name}_${folderName}_${timestamp}.jpg`;
                    link.href = canvas.toDataURL('image/jpeg', 0.95);
                    link.click();

                    if (i < templates.length - 1) {
                        await new Promise(resolve => setTimeout(resolve, 800));
                    }
                }

                showToast('ğŸ’¾ å››ä¸ªæ¨¡æ¿å…¨éƒ¨ä¸‹è½½æˆåŠŸï¼');
            } catch (error) {
                console.error('ä¸‹è½½é”™è¯¯:', error);
                alert('ä¸‹è½½å¤±è´¥ï¼š' + error.message);
            } finally {
                loading.classList.remove('active');
                loadingText.textContent = 'æ­£åœ¨ç”Ÿæˆ...';
            }
        }

        // æ˜¾ç¤ºå¤§å›¾æ¨¡æ€æ¡†
        async function showModal(cardId) {
            const card = document.getElementById(cardId);
            const modal = document.getElementById('modal');
            const modalContent = document.getElementById('modal-content');
            
            // ä¿®å¤å›¾ç‰‡ object-fit å¹¶æ¸²æŸ“é«˜æ¸…å¤§å›¾
            const originalData = fixImagesForCapture(card);
            
            const canvas = await html2canvas(card, {
                scale: 2,
                useCORS: true,
                allowTaint: false,
                backgroundColor: '#ffffff',
                logging: false
            });
            
            // æ¢å¤åŸå§‹å›¾ç‰‡
            restoreImages(originalData);

            modalContent.innerHTML = `<img src="${canvas.toDataURL('image/jpeg', 0.95)}" alt="é¢„è§ˆ">`;
            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }

        function showToast(message) {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: #333;
                color: #FECF78;
                padding: 16px 32px;
                border-radius: 10px;
                font-size: 16px;
                z-index: 10000;
                animation: fadeIn 0.3s ease;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => {
                toast.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 2000);
        }

        // æ·»åŠ åŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateX(-50%) translateY(-10px); }
                to { opacity: 1; transform: translateX(-50%) translateY(0); }
            }
            @keyframes fadeOut {
                from { opacity: 1; transform: translateX(-50%) translateY(0); }
                to { opacity: 0; transform: translateX(-50%) translateY(-10px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
